# Get editor completions based on the config schema
"$schema" = 'https://starship.rs/config-schema.json'

# Inserts a blank line between shell prompts
add_newline = true

format = """\
$time\
$all\
$character"""

[fill]
symbol = " "

[directory]
format = "in [$path]($style)[$read_only]($read_only_style) "

[package]
disabled = true

[character]
success_symbol = "[ îž€ ](bold bright-green)"
error_symbol = "[ îž€ ](bold red)"
# success_symbol = "[ó°œ¥](bold green)"

# [python]
# format = '[${symbol}${pyenv_prefix}(${version} )(\($virtualenv\) )]($style)'
#
# [rust]
# format = '[$symbol($version )]($style)'

# [golang]
# symbol = "î˜§ "
# format = '[$symbol($version )]($style)'

# [docker_context]
# format = '[$symbol$context ]($style)'

[time]
style = "bold yellow"
time_format = "%H:%M"
format = "[$time]($style) "
disabled = false

[aws]
disabled = true

[git_branch]
disabled = false

[git_status]
disabled = false

[git_commit]
disabled = false

[git_state]
disabled = false

[git_metrics]
disabled = false


[custom]
[custom.env_slug]
disabled = true
description = "Display ENVIRONMENT_SLUG if set and notify if "
when = """[[ $(git ls-remote --get-url) =~ ^gitlab.com:alcemy ]] && [[ -f $(git rev-parse --show-toplevel)/.env ]]"""
format = "(in [$symbol($output )]($style))"
style = "bold yellow"
command = """
SYMBOL=""
GIT_ROOT=$(git rev-parse --show-toplevel)
DYN_ENV=$(git branch --show-current | cut -s -d '+' -f 2)
ENV_SLUG=$(cat $GIT_ROOT/.env | grep "^ENVIRONMENT_SLUG" | xargs | cut -s -d '=' -f 2)

[[ -z $DYN_ENV ]] && [[ $ENV_SLUG == "testing" ]] && exit

[[ -z $DYN_ENV ]] && [[ $ENV_SLUG =~ ^dyn_ ]] && SYMBOL="ðŸš§ "
[[ -n $DYN_ENV ]] && [[ "dyn_$DYN_ENV" != $ENV_SLUG ]] && SYMBOL="ðŸš§ "

[[ -z $ENV_SLUG ]] && ENV_SLUG="<undefined env slug>"

[[ $ENV_SLUG =~ ^prod ]] && SYMBOL="ðŸ›‘ $SYMBOL" && ENV_SLUG=${ENV_SLUG^^}

echo "${SYMBOL}${ENV_SLUG}"
"""
shell = ["bash", "--noprofile", "--norc"]
